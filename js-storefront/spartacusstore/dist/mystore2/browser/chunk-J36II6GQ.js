import{pa as R}from"./chunk-ABA734YC.js";import{Aa as g,Ac as B,Dd as E,Eg as w,Fb as a,Gb as s,Hc as x,Ta as o,Ua as y,Xb as u,Yb as d,cb as v,cf as j,eb as h,ge as O,ja as m,kb as r,lb as c,nb as T,ob as D,og as F,pg as Q,ra as C,s as k,sa as f,tb as b,ua as I,uc as _,vc as S,za as M}from"./chunk-FDYREMOD.js";var N=(()=>{class e{constructor(t){this.productService=t,this.PRODUCT_SCOPE="bulkPrices"}getBulkPrices(t){return this.productService.get(t,this.PRODUCT_SCOPE).pipe(m(i=>k(this.convert(i))))}convert(t){let i=[];if(t){let n=t.price?.value;i=t.volumePrices?.map(l=>this.parsePrice(l,n))}return i}parsePrice(t,i){let n={currencyIso:t.currencyIso,formattedValue:t.formattedValue,maxQuantity:t.maxQuantity,minQuantity:t.minQuantity,priceType:t.priceType,value:t.value,formattedDiscount:"",discount:0};return this.calculateDiscount(n,i)}calculateDiscount(t,i){let n=Object.assign({},t),P=t.value;if(P&&i){let l=Math.round(100-P/i*100),U=l===0?`${l}%`:`-${l}%`;n.formattedDiscount=U,n.discount=l}return n}static{this.\u0275fac=function(i){return new(i||e)(I(w))}}static{this.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function A(e,p){if(e&1&&(r(0,"tr")(1,"td"),a(2),c(),r(3,"td"),a(4),c(),r(5,"td"),a(6),c()()),e&2){let t=p.$implicit,i=b(3);o(2),s(i.formatQuantity(t)),o(2),s(t.formattedValue),o(2),s(t.formattedDiscount)}}function K(e,p){if(e&1&&(r(0,"div",2)(1,"table",3)(2,"thead",4)(3,"tr")(4,"th",5),a(5),u(6,"cxTranslate"),c(),r(7,"th",5),a(8),u(9,"cxTranslate"),c(),r(10,"th",5),a(11),u(12,"cxTranslate"),c()()(),r(13,"tbody"),v(14,A,7,3,"tr",6),c()()()),e&2){let t=b().ngIf;o(5),s(d(6,4,"bulkPricingTable.quantity")),o(3),s(d(9,6,"bulkPricingTable.price")),o(3),s(d(12,8,"bulkPricingTable.discount")),o(3),h("ngForOf",t)}}function Y(e,p){if(e&1&&(T(0),v(1,K,15,10,"div",1),D()),e&2){let t=p.ngIf;o(),h("ngIf",t.length>0)}}var q=(()=>{class e{constructor(t,i){this.routingService=t,this.bulkPricingService=i,this.PRODUCT_KEY="productCode"}ngOnInit(){this.priceTiers$=this.getPrices()}formatQuantity(t){let i="";return t.maxQuantity?i=t.minQuantity+" - "+t.maxQuantity:i=t.minQuantity+"+",i}getPrices(){return this.routingService.getRouterState().pipe(m(t=>{let i=t.state.params[this.PRODUCT_KEY];return this.bulkPricingService.getBulkPrices(i)}))}static{this.\u0275fac=function(i){return new(i||e)(y(O),y(N))}}static{this.\u0275cmp=M({type:e,selectors:[["cx-bulk-pricing-table"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","cx-bulk-pricing-table-container",4,"ngIf"],[1,"cx-bulk-pricing-table-container"],[1,"table"],[1,"thead-light"],["scope","col"],[4,"ngFor","ngForOf"]],template:function(i,n){i&1&&(v(0,Y,2,1,"ng-container",0),u(1,"async")),i&2&&h("ngIf",d(1,1,n.priceTiers$))},dependencies:[_,S,B,F],encapsulation:2})}}return e})(),z=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=f({imports:[x,Q,R,j.withConfig({cmsComponents:{BulkPricingTableComponent:{component:q}}})]})}}return e})(),G={backend:{occ:{endpoints:{product:{bulkPrices:"orgProducts/${productCode}?fields=price(DEFAULT),volumePrices(FULL)"}}}}},H=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=f({providers:[E(G)],imports:[x]})}}return e})(),nt=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=f({imports:[H,z]})}}return e})();export{nt as BulkPricingModule};
