import{R as w,S as ve,a as ee}from"./chunk-PWBMBWIR.js";import{$ as rt,Ca as fe,D as Ze,E as et,Ea as at,Ga as xe,Ha as st,L as tt,M as it,N as nt,Q as U,Rb as pt,Tb as _e,Y as de,_ as ue,b as Ye,c as P,d as ae,e as se,g as pe,ic as Z,j as G,ja as ot,l as ce,nb as ge,o as me,p as le,s as Xe,sc as ct,x as Je}from"./chunk-ABA734YC.js";import{Aa as b,Ac as A,Bb as Ne,Cb as Oe,Db as Pe,Dd as K,Eb as L,Fa as v,Fb as d,Ga as E,Gb as Be,Gf as Ke,Hb as u,Hc as W,I as ne,La as H,Me as qe,Ne as ze,Ob as ke,Pf as oe,Qb as Q,R as re,Ta as r,Ua as g,Xb as p,Yb as l,Zb as I,Ze as He,Zf as X,_ as be,a as $,ac as R,b as V,bb as Fe,cb as x,cf as Y,db as Me,df as Qe,eb as o,ef as We,f as Ce,h as Ie,i as Se,ia as Te,ib as $e,ja as z,kb as a,lb as s,ma as we,mb as h,nb as N,ob as O,og as M,pg as J,qb as C,ra as j,s as B,sa as S,sb as _,tb as m,ua as F,uc as je,v as k,vc as T,vd as Ge,w as De,wb as Ve,wc as Le,xc as Re,yc as Ae,za as D,zd as Ue}from"./chunk-FDYREMOD.js";var te=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:function(i){let n=null;return i?n=new(i||t):n=F(Ue),n},providedIn:"root"})}}return t})(),q=function(t){return t.FILE_NAME="fileName",t.DATE_TIME="dateTime",t}(q||{}),vt={cartImportExport:{file:{separator:","},import:{fileValidity:{maxSize:1,maxEntries:{[w.NEW_SAVED_CART]:100,[w.SAVED_CART]:100,[w.ACTIVE_CART]:10,[w.QUICK_ORDER]:10},allowedTypes:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv",".csv"]},cartNameGeneration:{source:q.FILE_NAME}},export:{additionalColumns:[{name:{key:"name"},value:"product.name"},{name:{key:"price"},value:"totalPrice.formattedValue"}],messageEnabled:!0,downloadDelay:1e3,maxEntries:1e3,fileOptions:{fileName:"cart",extension:"csv",type:"text/csv"}}}},lt=(()=>{class t{static forRoot(){return{ngModule:t,providers:[K(vt)]}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=S({})}}return t})();function yt(t,f){if(t&1){let e=C();a(0,"button",1),_("click",function(){let n=v(e).ngIf,c=m();return E(c.exportCsv(n))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),u(" ",l(2,1,"exportEntries.exportProductToCsv"),`
`))}var ht=["open"];function Ct(t,f){if(t&1){let e=C();a(0,"button",1),_("click",function(){let n=v(e).ngIf,c=m();return E(c.openDialog(n))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),u(" ",l(2,1,"importEntries.importProducts"),`
`))}function It(t,f){if(t&1){let e=C();a(0,"form",1),_("submit",function(){v(e);let n=m();return E(n.formSubmitSubject$.next(void 0))}),a(1,"p",2),d(2),p(3,"cxTranslate"),s(),a(4,"p"),d(5),p(6,"cxTranslate"),s(),a(7,"label")(8,"cx-file-upload",3),d(9),p(10,"cxTranslate"),s(),h(11,"cx-form-errors",4),s(),a(12,"div",5)(13,"button",6),_("click",function(){v(e);let n=m();return E(n.close("Close Import Products Dialog"))}),d(14),p(15,"cxTranslate"),s(),a(16,"button",7),d(17),p(18,"cxTranslate"),s()()()}if(t&2){let e,i=m();o("formGroup",i.form),r(2),u(" ",l(3,10,"importEntriesDialog.importProductsSubtitle")," "),r(3),u(" ",l(6,12,"importEntriesDialog.importProductFileDetails")," "),r(3),o("formControl",i.form.get("file"))("accept",i.allowedTypes),r(),u(" ",l(10,14,"importEntriesDialog.selectFile")," "),r(2),o("control",i.form.get("file")),r(3),u(" ",l(15,16,"importEntriesDialog.cancel")," "),r(2),o("disabled",((e=i.form.get("file"))==null?null:e.status)==="PENDING"),r(),u(" ",l(18,18,"importEntriesDialog.upload")," ")}}var Ee=t=>({count:t});function St(t,f){if(t&1&&(N(0),d(1),p(2,"cxTranslate"),O()),t&2){let e=m(2);r(),u(" ",I(2,1,"importEntriesDialog.summary.loaded",e.summary)," ")}}function Dt(t,f){if(t&1&&(N(0),d(1),p(2,"cxTranslate"),O()),t&2){let e=m(2);r(),u(" ",I(2,1,"importEntriesDialog.summary.loadedToCart",e.summary)," ")}}function bt(t,f){if(t&1&&(a(0,"p",9),x(1,St,3,4,"ng-container",10)(2,Dt,3,4,"ng-container",11),s()),t&2){let e=m();o("ngSwitch",e.type),r(),o("ngSwitchCase",e.orderEntriesSource.QUICK_ORDER)}}function Tt(t,f){if(t&1&&(a(0,"p"),d(1),p(2,"cxTranslate"),s()),t&2){let e=m();r(),u(" ",I(2,1,"importEntriesDialog.summary.loading",e.summary)," ")}}function wt(t,f){if(t&1&&(a(0,"p",12),h(1,"cx-icon",13),d(2),p(3,"cxTranslate"),s()),t&2){let e=m();r(),o("type",e.iconTypes.SUCCESS),r(),u(" ",I(3,2,"importEntriesDialog.summary.successes",e.summary),`
`)}}function Ft(t,f){if(t&1&&(a(0,"li"),d(1),p(2,"cxTranslate"),s()),t&2){let e=f.$implicit;r(),u(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function Mt(t,f){if(t&1&&(a(0,"ul"),x(1,Ft,3,4,"li",18),s()),t&2){let e=m(2);r(),o("ngForOf",e.summary.warningMessages)}}function $t(t,f){if(t&1){let e=C();a(0,"div",14)(1,"p"),h(2,"cx-icon",15),d(3),p(4,"cxTranslate"),a(5,"button",16),_("click",function(){v(e);let n=m();return E(n.toggleWarningList())}),d(6),p(7,"cxTranslate"),s()(),x(8,Mt,2,1,"ul",17),s()}if(t&2){let e=m();r(2),o("type",e.iconTypes.ERROR),r(),u(" ",I(4,4,"importEntriesDialog.summary.warning",Q(9,Ee,e.summary.warningMessages.length))," "),r(3),u(" ",l(7,7,e.warningDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.warningDetailsOpened)}}function Vt(t,f){if(t&1&&(a(0,"li"),d(1),p(2,"cxTranslate"),s()),t&2){let e=f.$implicit;r(),u(" ",I(2,1,"importEntriesDialog.summary.messages."+e.statusCode,e)," ")}}function Nt(t,f){if(t&1&&(a(0,"ul"),x(1,Vt,3,4,"li",18),s()),t&2){let e=m(2);r(),o("ngForOf",e.summary.errorMessages)}}function Ot(t,f){if(t&1){let e=C();a(0,"div",19)(1,"p"),h(2,"cx-icon",20),d(3),p(4,"cxTranslate"),a(5,"button",16),_("click",function(){v(e);let n=m();return E(n.toggleErrorList())}),d(6),p(7,"cxTranslate"),s()(),x(8,Nt,2,1,"ul",17),s()}if(t&2){let e=m();r(2),o("type",e.iconTypes.RESET),r(),u(" ",I(4,4,"importEntriesDialog.summary.error",Q(9,Ee,e.summary.errorMessages.length))," "),r(3),u(" ",l(7,7,e.errorDetailsOpened?"importEntriesDialog.summary.hide":"importEntriesDialog.summary.show")," "),r(2),o("ngIf",e.errorDetailsOpened)}}function Pt(t,f){if(t&1){let e=C();a(0,"button",21),_("click",function(){v(e);let n=m();return E(n.close("Close Import Products Dialog"))}),d(1),p(2,"cxTranslate"),s()}t&2&&(r(),u(" ",l(2,1,"importEntriesDialog.close")," "))}function Bt(t,f){t&1&&(a(0,"p"),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),Be(l(2,1,"importEntriesDialog.summary.info")))}function kt(t,f){if(t&1){let e=C();a(0,"form",1),_("submit",function(){v(e);let n=m();return E(n.formSubmitSubject$.next(void 0))}),a(1,"p",2),d(2),p(3,"cxTranslate"),s(),a(4,"p"),d(5),p(6,"cxTranslate"),s(),a(7,"label")(8,"cx-file-upload",3),_("update",function(){v(e);let n=m();return E(n.updateCartName())}),d(9),p(10,"cxTranslate"),s(),h(11,"cx-form-errors",4),s(),a(12,"div",5)(13,"label")(14,"span",6),d(15),p(16,"cxTranslate"),s(),h(17,"input",7)(18,"cx-form-errors",8),s()(),a(19,"div",5)(20,"label")(21,"span",6),d(22),p(23,"cxTranslate"),a(24,"span",9),d(25),p(26,"cxTranslate"),s()(),h(27,"textarea",10)(28,"cx-form-errors",8),a(29,"p",11),d(30),p(31,"cxTranslate"),s()()(),a(32,"div",12)(33,"button",13),_("click",function(){v(e);let n=m();return E(n.close("Close Import Products Dialog"))}),d(34),p(35,"cxTranslate"),s(),a(36,"button",14),d(37),p(38,"cxTranslate"),s()()()}if(t&2){let e,i=m();o("formGroup",i.form),r(2),u(" ",l(3,18,"importEntriesDialog.importProductsNewSavedCartSubtitle")," "),r(3),u(" ",l(6,20,"importEntriesDialog.importProductFileDetails")," "),r(3),o("formControl",i.form.get("file"))("accept",i.allowedTypes),r(),u(" ",l(10,22,"importEntriesDialog.selectFile")," "),r(2),o("control",i.form.get("file")),r(4),u(" ",l(16,24,"importEntriesDialog.savedCartName")," "),r(2),o("maxLength",i.nameMaxLength),r(),o("control",i.form.get("name")),r(4),u(" ",l(23,26,"importEntriesDialog.savedCartDescription")," "),r(3),u(" (",l(26,28,"importEntriesDialog.optional"),") "),r(2),o("maxLength",i.descriptionMaxLength),r(),o("control",i.form.get("description")),r(2),u(" ",I(31,30,"importEntriesDialog.charactersLeft",Q(37,Ee,i.descriptionsCharacterLeft))," "),r(4),u(" ",l(35,33,"importEntriesDialog.cancel")," "),r(2),o("disabled",((e=i.form.get("file"))==null?null:e.status)==="PENDING"),r(),u(" ",l(38,35,"importEntriesDialog.upload")," ")}}function jt(t,f){t&1&&(a(0,"h3",10),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),u(" ",l(2,1,"importEntriesDialog.importProducts")," "))}function Lt(t,f){t&1&&(a(0,"div",10),d(1),p(2,"cxTranslate"),s()),t&2&&(r(),u(" ",l(2,1,"importEntriesDialog.importProducts")," "))}function Rt(t,f){if(t&1){let e=C();a(0,"cx-import-to-new-saved-cart-form",13),_("submitEvent",function(n){v(e);let c=m(2).ngIf,y=m();return E(y.importProducts(c,n))}),s()}if(t&2){let e=m(2).ngIf;o("type",e.type)}}function At(t,f){if(t&1){let e=C();a(0,"cx-import-entries-form",13),_("submitEvent",function(n){v(e);let c=m(2).ngIf,y=m();return E(y.importProducts(c,n))}),s()}if(t&2){let e=m(2).ngIf;o("type",e.type)}}function Gt(t,f){if(t&1&&(N(0),x(1,Rt,1,1,"cx-import-to-new-saved-cart-form",12)(2,At,1,1,"ng-template",null,1,R),O()),t&2){let e=L(3),i=m().ngIf,n=m();r(),o("ngIf",n.isNewCartForm(i))("ngIfElse",e)}}function Ut(t,f){if(t&1){let e=C();a(0,"cx-import-entries-summary",14),p(1,"async"),_("closeEvent",function(){v(e);let n=m(2);return E(n.close("Close Import Products Dialog"))}),s()}if(t&2){let e=m().ngIf,i=m();o("summary",l(1,2,i.summary$))("type",e.type)}}function qt(t,f){if(t&1&&(N(0),x(1,Gt,4,2,"ng-container",11)(2,Ut,2,4,"ng-template",null,0,R),O()),t&2){let e=L(3),i=m();r(),o("ngIf",i.formState)("ngIfElse",e)}}function zt(t,f){t&1&&h(0,"cx-import-order-entries")}function Ht(t,f){t&1&&h(0,"cx-export-order-entries")}var Qt=(()=>{class t{constructor(e,i,n,c){this.exportCsvFileService=e,this.importExportConfig=i,this.globalMessageService=n,this.translationService=c,this.columns=[{name:{key:"code"},value:"product.code"},{name:{key:"quantity"},value:"quantity"},...this.exportConfig?.additionalColumns??[]]}get exportConfig(){return this.importExportConfig.cartImportExport?.export}get separator(){return this.importExportConfig.cartImportExport?.file.separator}downloadCsv(e){this.getResolvedEntries(e).pipe(re(1)).subscribe(i=>this.download(i))}resolveValue(e,i){return e.split(".").reduce((n,c)=>n?n[c]:"",i)?.toString()??""}resolveValues(e){return e.map(i=>this.columns.map(n=>this.resolveValue(n.value,i)))}getTranslatedColumnHeaders(){return De(this.columns.map(e=>this.translationService.translate(`exportEntries.columnNames.${e.name.key}`)))}displayExportMessage(){this.globalMessageService.add({key:"exportEntries.exportMessage"},qe.MSG_TYPE_INFO)}limitValues(e){return this.exportConfig?.maxEntries?e.splice(0,this.exportConfig?.maxEntries):e}getResolvedEntries(e){let i=this.limitValues(this.resolveValues(e));return this.getTranslatedColumnHeaders().pipe(k(n=>[n,...i]))}download(e){this.exportConfig?.messageEnabled&&this.displayExportMessage(),setTimeout(()=>{this.exportConfig!==void 0&&this.separator!==void 0&&this.exportCsvFileService.download(e,this.separator,this.exportConfig.fileOptions)},this.exportConfig?.downloadDelay??0)}static{this.\u0275fac=function(i){return new(i||t)(F(pt),F(te),F(ze),F(Ke))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),dt=(()=>{class t{constructor(e,i){this.exportEntriesService=e,this.contextService=i,this.styles="container",this.orderEntriesContext$=this.contextService.get(ee),this.entries$=this.orderEntriesContext$.pipe(z(n=>n?.getEntries?.()??B(void 0)))}exportCsv(e){this.exportEntriesService.downloadCsv(e)}static{this.\u0275fac=function(i){return new(i||t)(g(Qt),g(Z))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-export-order-entries"]],hostVars:2,hostBindings:function(i,n){i&2&&$e(n.styles)},decls:3,vars:5,consts:[["class","btn btn-tertiary cx-export-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-export-btn",3,"click"]],template:function(i,n){if(i&1&&(x(0,yt,3,3,"button",0),p(1,"async"),p(2,"async")),i&2){let c;o("ngIf",((c=l(1,1,n.entries$))==null?null:c.length)>0&&l(2,3,n.entries$))}},dependencies:[T,A,M],encapsulation:2,changeDetection:0})}}return t})(),ye=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=S({imports:[W,Ge,J,oe,Y.withConfig({cmsComponents:{ExportOrderEntriesComponent:{component:dt}}})]})}}return t})(),ut=(()=>{class t{constructor(e,i){this.launchDialogService=e,this.contextService=i,this.subscription=new Ce,this.orderEntriesContext$=this.contextService.get(ee)}openDialog(e){this.launchDialogService.openDialogAndSubscribe("IMPORT_TO_CART",this.element,{orderEntriesContext:e})}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(Z))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-order-entries"]],viewQuery:function(i,n){if(i&1&&Ne(ht,5),i&2){let c;Oe(c=Pe())&&(n.element=c.first)}},decls:2,vars:3,consts:[["class","btn btn-tertiary cx-import-btn",3,"click",4,"ngIf"],[1,"btn","btn-tertiary","cx-import-btn",3,"click"]],template:function(i,n){i&1&&(x(0,Ct,3,3,"button",0),p(1,"async")),i&2&&o("ngIf",l(1,1,n.orderEntriesContext$))},dependencies:[T,A,M],encapsulation:2,changeDetection:0})}}return t})(),ft=(()=>{class t{constructor(){}csvDataToProduct(e){return e.map(i=>({productCode:i[0],quantity:Number(i[1])}))}isDataParsableToProducts(e){let i=new RegExp(/(?:\s|^)\d+(?=\s|$)/);return e.length>0&&e.every(n=>i.test(n[1]))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})(),xt=(()=>{class t{constructor(e,i,n,c,y){this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=c,this.importExportConfig=y,this.formSubmitSubject$=new Ie,this.submitEvent=new H}ngOnInit(){this.form=this.buildForm(),this.formSubmitSubject$.pipe(we(()=>{this.form.invalid&&(this.form.markAllAsTouched(),ct.deepUpdateValueAndValidity(this.form))}),z(()=>this.form.statusChanges.pipe(Te(this.form.get("file")?.status),ne(e=>e!=="PENDING"),re(1))),ne(e=>e==="VALID")).subscribe(()=>{this.save()})}close(e){this.launchDialogService.closeDialog(e)}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i)})})}buildForm(){let e=new pe({});return e.setControl("file",new G("",[P.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):B(null)])),e}get allowedTypes(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.allowedTypes}get maxSize(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxSize}get maxEntries(){return this.importExportConfig.cartImportExport?.import?.fileValidity?.maxEntries?.[this.type]}get separator(){return this.importExportConfig.cartImportExport?.file.separator}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(ft),g(_e),g(ge),g(te))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-form"]],inputs:{type:"type"},outputs:{submitEvent:"submitEvent"},decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[1,"cx-import-entries-subtitle"],[3,"formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(i,n){i&1&&x(0,It,19,20,"form",0),i&2&&o("ngIf",n.form)},dependencies:[T,ce,ae,se,me,le,fe,xe,M],encapsulation:2,changeDetection:0})}}return t})(),Wt=(()=>{class t{constructor(){this.iconTypes=de,this.orderEntriesSource=w,this.warningDetailsOpened=!1,this.errorDetailsOpened=!1,this.closeEvent=new H}close(e){this.closeEvent.emit(e)}toggleWarningList(){this.warningDetailsOpened=!this.warningDetailsOpened}toggleErrorList(){this.errorDetailsOpened=!this.errorDetailsOpened}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-summary"]],inputs:{type:"type",summary:"summary"},outputs:{closeEvent:"closeEvent"},decls:11,vars:7,consts:[["loading",""],["info",""],[1,"cx-import-entries-summary-status"],[3,"ngSwitch",4,"ngIf","ngIfElse"],["class","cx-import-entries-summary-successes",4,"ngIf"],["class","cx-import-entries-summary-warnings",4,"ngIf"],["class","cx-import-entries-summary-errors",4,"ngIf"],[1,"cx-import-entries-summary-footer"],["class","btn btn-secondary","type","button",3,"click",4,"ngIf","ngIfElse"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"cx-import-entries-summary-successes"],[1,"success",3,"type"],[1,"cx-import-entries-summary-warnings"],[1,"warning",3,"type"],[1,"btn","btn-tertiary",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"cx-import-entries-summary-errors"],[1,"error",3,"type"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(i,n){if(i&1&&(a(0,"div",2),x(1,bt,3,2,"p",3)(2,Tt,3,4,"ng-template",null,0,R),s(),x(4,wt,4,5,"p",4)(5,$t,9,11,"div",5)(6,Ot,9,11,"div",6),a(7,"div",7),x(8,Pt,3,3,"button",8)(9,Bt,3,3,"ng-template",null,1,R),s()),i&2){let c=L(3),y=L(10);r(),o("ngIf",!n.summary.loading)("ngIfElse",c),r(3),o("ngIf",n.summary.successesCount>0),r(),o("ngIf",n.summary.warningMessages.length>0),r(),o("ngIf",n.summary.errorMessages.length>0),r(2),o("ngIf",!n.summary.loading)("ngIfElse",y)}},dependencies:[je,T,Le,Re,Ae,ue,M],encapsulation:2,changeDetection:0})}}return t})(),Kt=(()=>{class t extends xt{get descriptionsCharacterLeft(){return this.descriptionMaxLength-(this.form.get("description")?.value?.length||0)}constructor(e,i,n,c,y,ie){super(e,i,n,c,y),this.launchDialogService=e,this.importToCartService=i,this.importCsvService=n,this.filesFormValidators=c,this.importExportConfig=y,this.datePipe=ie,this.descriptionMaxLength=250,this.nameMaxLength=50,this.submitEvent=new H}save(){let e=this.form.get("file")?.value?.[0];this.separator!==void 0&&this.importCsvService.loadFile(e,this.separator).subscribe(i=>{this.submitEvent.emit({products:this.importToCartService.csvDataToProduct(i),savedCartInfo:{name:this.form.get("name")?.value,description:this.form.get("description")?.value}})})}buildForm(){let e=new pe({});return e.setControl("file",new G("",[P.required,this.filesFormValidators.maxSize(this.maxSize)],[i=>this.separator!==void 0?this.importCsvService.validateFile(i.value[0],{separator:this.separator,isDataParsable:this.importToCartService.isDataParsableToProducts,maxEntries:this.maxEntries}):B(null)])),e.setControl("name",new G("",[P.required,P.maxLength(this.nameMaxLength)])),e.setControl("description",new G("",[P.maxLength(this.descriptionMaxLength)])),e}updateCartName(){let e=this.form.get("name");if(e&&!e?.value&&this.cartNameGeneration?.source)switch(this.cartNameGeneration.source){case q.FILE_NAME:{this.setFieldValueByFileName(e);break}case q.DATE_TIME:{this.setFieldValueByDatetime(e);break}default:break}}setFieldValueByFileName(e){let i=this.form.get("file")?.value?.[0]?.name?.replace(/\.[^/.]+$/,"");e.setValue(i)}setFieldValueByDatetime(e){let i=new Date,n=this.cartNameGeneration?.fromDateOptions,c=n?.mask,y=n?.prefix??"",ie=n?.suffix??"",_t=c?this.datePipe.transform(i,c):this.datePipe.transform(i);e.setValue(`${y}${_t}${ie}`)}get cartNameGeneration(){return this.importExportConfig.cartImportExport?.import?.cartNameGeneration}static{this.\u0275fac=function(i){return new(i||t)(g(U),g(ft),g(_e),g(ge),g(te),g(X))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-to-new-saved-cart-form"]],outputs:{submitEvent:"submitEvent"},features:[ke([X]),Fe],decls:1,vars:1,consts:[[3,"formGroup","submit",4,"ngIf"],[3,"submit","formGroup"],[1,"cx-import-entries-subtitle"],[3,"update","formControl","accept"],["prefix","formErrors.file",3,"control"],[1,"cx-import-entries-row"],[1,"cx-import-entries-label","label-content"],["formControlName","name","required","","type","text",1,"form-control",3,"maxLength"],[3,"control"],[1,"cx-import-entries-label-optional"],["formControlName","description","rows","5",1,"form-control",3,"maxLength"],[1,"cx-import-entries-input-hint"],[1,"cx-import-entries-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(i,n){i&1&&x(0,kt,39,39,"form",0),i&2&&o("ngIf",n.form)},dependencies:[T,ce,Ye,ae,se,Je,me,le,Xe,fe,xe,M],encapsulation:2,changeDetection:0})}}return t})(),Yt=(()=>{class t{constructor(e){this.launchDialogService=e,this.iconTypes=de,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},this.formState=!0,this.summary$=new Se({loading:!1,cartName:"",count:0,total:0,successesCount:0,warningMessages:[],errorMessages:[]}),this.context$=this.launchDialogService.data$.pipe(k(i=>i.orderEntriesContext)),We("a11yVisibleFocusOverflows")}isNewCartForm(e){return e.type===w.NEW_SAVED_CART}close(e){this.launchDialogService.closeDialog(e)}importProducts(e,{products:i,savedCartInfo:n}){this.formState=!1,this.summary$.next(V($({},this.summary$.value),{loading:!0,total:i.length,cartName:n?.name})),e.addEntries(i,n).pipe(be(()=>{this.summary$.next(V($({},this.summary$.value),{loading:!1}))})).subscribe(c=>{this.populateSummary(c)})}populateSummary(e){e.statusCode===ve.SUCCESS?this.summary$.next(V($({},this.summary$.value),{count:this.summary$.value.count+1,successesCount:this.summary$.value.successesCount+1})):e.statusCode===ve.LOW_STOCK?this.summary$.next(V($({},this.summary$.value),{count:this.summary$.value.count+1,warningMessages:[...this.summary$.value.warningMessages,e]})):this.summary$.next(V($({},this.summary$.value),{count:this.summary$.value.count+1,errorMessages:[...this.summary$.value.errorMessages,e]}))}static{this.\u0275fac=function(i){return new(i||t)(g(U))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-entries-dialog"]],decls:14,vars:16,consts:[["importSummary",""],["reducedForm",""],["role","dialog","aria-labelledby","dialogTitle",1,"cx-import-entries-dialog",3,"esc","cxFocus"],[1,"cx-import-entries-container"],[1,"modal-header","cx-import-entries-header"],["id","dialogTitle","class","cx-import-entries-title modal-title",4,"cxFeature"],["type","button",1,"cx-import-entries-close","close",3,"click","title","disabled"],["aria-hidden","true"],[3,"type"],[4,"ngIf"],["id","dialogTitle",1,"cx-import-entries-title","modal-title"],[4,"ngIf","ngIfElse"],[3,"type","submitEvent",4,"ngIf","ngIfElse"],[3,"submitEvent","type"],[3,"closeEvent","summary","type"]],template:function(i,n){if(i&1&&(a(0,"div",2),_("esc",function(){return n.close("Escape clicked")}),a(1,"div",3)(2,"div",4),N(3),x(4,jt,3,3,"h3",5)(5,Lt,3,3,"div",5),O(),a(6,"button",6),p(7,"cxTranslate"),p(8,"async"),p(9,"cxTranslate"),_("click",function(){return n.close("Close Import Products Dialog")}),a(10,"span",7),h(11,"cx-icon",8),s()()(),x(12,qt,4,2,"ng-container",9),p(13,"async"),s()()),i&2){let c;o("cxFocus",n.focusConfig),r(4),o("cxFeature","a11yDialogsHeading"),r(),o("cxFeature","!a11yDialogsHeading"),r(),Ve("title",l(7,8,"importEntriesDialog.close")),o("disabled",(c=l(8,10,n.summary$))==null?null:c.loading),Me("aria-label",l(9,12,"importEntriesDialog.close")),r(5),o("type",n.iconTypes.CLOSE),r(),o("ngIf",l(13,14,n.context$))}},dependencies:[T,ue,tt,He,xt,Wt,Kt,A,M],encapsulation:2,changeDetection:0})}}return t})(),Xt={launch:{IMPORT_TO_CART:{inlineRoot:!0,component:Yt,dialogType:nt.DIALOG}}},he=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=S({providers:[K(Xt)],imports:[W,Ze,et,at,rt,it,st,J,Y.withConfig({cmsComponents:{ImportOrderEntriesComponent:{component:ut}}}),Qe]})}}return t})(),Jt=(()=>{class t{constructor(e){this.contextService=e,this.context$=this.contextService.get(ee),this.shouldDisplayImport$=this.context$.pipe(k(i=>!!i?.addEntries)),this.shouldDisplayExport$=this.context$.pipe(z(i=>i?.getEntries?.()??B([])),k(i=>!!i?.length))}static{this.\u0275fac=function(i){return new(i||t)(g(Z))}}static{this.\u0275cmp=D({type:t,selectors:[["cx-import-export-order-entries"]],decls:4,vars:6,consts:[[4,"ngIf"]],template:function(i,n){i&1&&(x(0,zt,1,0,"cx-import-order-entries",0),p(1,"async"),x(2,Ht,1,0,"cx-export-order-entries",0),p(3,"async")),i&2&&(o("ngIf",l(1,2,n.shouldDisplayImport$)),r(2),o("ngIf",l(3,4,n.shouldDisplayExport$)))},dependencies:[ut,dt,T,A],encapsulation:2,changeDetection:0})}}return t})(),gt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=S({imports:[ot,Y.withConfig({cmsComponents:{ImportExportOrderEntriesComponent:{component:Jt}}}),J,oe,he,ye,W]})}}return t})();var Ti=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=S({imports:[lt.forRoot(),ye,he,gt]})}}return t})();export{Ti as ImportExportModule};
