import{$ as Me,Aa as Ee,L as we,M as Pe,N as Ze,O as re,Q as ce,X as Ve,Y,_ as j,_b as De,da as ze,na as me,oa as se,ya as Q,za as ke}from"./chunk-ABA734YC.js";import{Aa as S,Ac as $,Bb as M,C as X,Cb as z,Db as k,Dd as ne,Eb as J,Fa as _,Fb as ee,G as U,Ga as g,Hb as te,Hc as ve,I as C,Ka as V,La as L,Qb as fe,R as le,Ta as c,Ua as v,V as ue,Xb as l,Yb as u,Ye as ye,Zb as he,Ze as ae,_a as _e,ab as ge,ac as ie,bb as xe,cb as x,db as B,df as be,eb as r,ef as N,f as A,fa as W,gb as K,gc as Ie,i as y,ja as E,je as oe,kb as d,lb as p,ma as P,mb as h,nb as b,ob as T,og as R,pg as Te,qb as I,s as de,sa as D,sb as f,tb as a,v as O,va as pe,vc as F,vd as Ce,w as H,wb as q,za as Z}from"./chunk-FDYREMOD.js";function Ae(i,m){if(i&1&&h(0,"cx-carousel",3),i&2){let e=a().ngIf;a();let t=J(3);r("items",e)("hideIndicators",!1)("template",t)}}function Oe(i,m){if(i&1&&(b(0),x(1,Ae,1,3,"cx-carousel",2),T()),i&2){let e=m.ngIf;c(),r("ngIf",e.length)}}function Le(i,m){if(i&1){let e=I();d(0,"cx-media",4),l(1,"async"),f("focus",function(){let n=_(e).item,o=a();return g(o.openImage(n.container))}),p()}if(i&2){let e=m.item,t=a();K("is-active",u(1,3,t.isActive(e.container))),r("container",e.container)}}var Fe=["defaultImage"],$e=["zoomContainer"],Ne=["zoomedImage"],Ye=["zoomButton"];function je(i,m){if(i&1){let e=I();d(0,"button",12),f("click",function(){let n=_(e).ngIf,o=a(3);return g(o.openImage(n.container))}),h(1,"cx-icon",13),p()}if(i&2){let e=a(3);c(),r("type",e.iconType.CARET_LEFT)}}function Qe(i,m){if(i&1){let e=I();d(0,"cx-media",18,0),f("loaded",function(){_(e);let n=a(4);return g(n.onImageLoad())}),p()}if(i&2){let e=a(3).ngIf;r("container",e)}}function Ge(i,m){if(i&1){let e=I();d(0,"div",19,1)(2,"cx-media",20,2),f("mousemove",function(n){_(e);let o=a(4);return g(o.pointerMove(n))})("touchmove",function(n){_(e);let o=a(4);return g(o.touchMove(n))})("touchend",function(){_(e);let n=a(4);return g(n.clearTouch())})("loaded",function(){_(e);let n=a(4);return g(n.onImageLoad())}),p()()}if(i&2){let e=a(3).ngIf;c(2),r("container",e)}}function He(i,m){if(i&1&&h(0,"cx-icon",23),i&2){let e=a(5);r("type",e.iconType.SEARCH_PLUS)}}function Xe(i,m){if(i&1&&h(0,"cx-icon",23),i&2){let e=a(5);r("type",e.iconType.SEARCH_MINUS)}}function Ue(i,m){if(i&1){let e=I();d(0,"button",21,3),l(2,"cxTranslate"),l(3,"cxTranslate"),l(4,"cxTranslate"),l(5,"cxTranslate"),f("click",function(){_(e);let n=a(4);return g(n.zoom())}),x(6,He,1,1,"cx-icon",22)(7,Xe,1,1,"cx-icon",22),p()}if(i&2){let e=a(4);q("title",e.isZoomed?u(2,4,"common.zoomOut"):u(3,6,"common.zoomIn")),B("aria-label",e.isZoomed?u(4,8,"common.zoomOut"):u(5,10,"common.zoomIn")),c(6),r("ngIf",!e.isZoomed),c(),r("ngIf",e.isZoomed)}}function We(i,m){if(i&1&&(d(0,"div",14),x(1,Qe,2,1,"cx-media",15)(2,Ge,4,1,"div",16)(3,Ue,8,12,"button",17),l(4,"async"),p()),i&2){let e=a(3);c(),r("ngIf",!e.isZoomed),c(),r("ngIf",e.isZoomed),c(),r("ngIf",u(4,3,e.imageLoaded))}}function Ke(i,m){if(i&1&&h(0,"cx-media",25,0),i&2){let e=a(3).ngIf;r("container",e)}}function qe(i,m){if(i&1){let e=I();d(0,"div",19,1)(2,"cx-media",26,2),f("mousemove",function(n){_(e);let o=a(4);return g(o.pointerMove(n))})("touchmove",function(n){_(e);let o=a(4);return g(o.touchMove(n))})("touchend",function(){_(e);let n=a(4);return g(n.clearTouch())}),p()()}if(i&2){let e=a(3).ngIf;c(2),r("container",e)}}function Je(i,m){if(i&1&&(b(0),x(1,Ke,2,1,"cx-media",24)(2,qe,4,1,"div",16),T()),i&2){let e=a(3);c(),r("ngIf",!e.isZoomed),c(),r("ngIf",e.isZoomed)}}function et(i,m){if(i&1){let e=I();d(0,"button",12),f("click",function(){let n=_(e).ngIf,o=a(3);return g(o.openImage(n.container))}),h(1,"cx-icon",13),p()}if(i&2){let e=a(3);c(),r("type",e.iconType.CARET_RIGHT)}}function tt(i,m){if(i&1&&(d(0,"div",7)(1,"div",8),x(2,je,2,1,"button",9),l(3,"async"),p(),x(4,We,5,5,"div",10)(5,Je,3,2,"ng-container",11),d(6,"div",8),x(7,et,2,1,"button",9),l(8,"async"),p()()),i&2){let e=m.ngIf,t=a(2);c(2),r("ngIf",u(3,4,t.getPreviousProduct(e))),c(2),r("cxFeature","a11yKeyboardAccessibleZoom"),c(),r("cxFeature","!a11yKeyboardAccessibleZoom"),c(2),r("ngIf",u(8,6,t.getNextProduct(e)))}}function it(i,m){if(i&1&&(b(0),x(1,tt,9,8,"div",6),l(2,"async"),T()),i&2){let e=a();c(),r("ngIf",u(2,1,e.thumbnails$))}}var nt=["expandButton"];function ot(i,m){if(i&1){let e=I();d(0,"button",3,0),f("click",function(){_(e);let n=a();return g(n.triggerZoom())}),ee(2),l(3,"cxTranslate"),h(4,"cx-icon",4),p()}if(i&2){let e=a();c(2),te(" ",u(3,2,"productImageZoomTrigger.expand")," "),c(2),r("type",e.iconType.EXPAND_ARROWS)}}function at(i,m){if(i&1){let e=I();d(0,"button",5,0),f("click",function(){_(e);let n=a();return g(n.triggerZoom())}),d(2,"span"),ee(3),l(4,"cxTranslate"),h(5,"cx-icon",4),p()()}if(i&2){let e=a();c(3),te(" ",u(4,2,"productImageZoomTrigger.expand")," "),c(2),r("type",e.iconType.EXPAND_ARROWS)}}var rt=i=>({product:i});function ct(i,m){if(i&1){let e=I();b(0),d(1,"cx-media",2),f("click",function(){_(e);let n=a();return g(n.triggerZoom(!0))}),p(),d(2,"cx-product-image-zoom-trigger",3),f("dialogClose",function(){_(e);let n=a();return g(n.triggerZoom(!1))}),p(),T()}if(i&2){let e=m.ngIf,t=a();c(),r("container",e),c(),r("expandImage",t.expandImage.value)("galleryIndex",t.selectedIndex)}}function mt(i,m){if(i&1&&(h(0,"cx-carousel",5),l(1,"cxTranslate")),i&2){let e=a().ngIf,t=a().ngIf;a();let n=J(5);r("items",t)("hideIndicators",!1)("template",n),B("aria-label",he(1,4,"carousel.carouselForProduct",fe(7,rt,e.name)))}}function st(i,m){if(i&1&&(b(0),x(1,mt,2,9,"cx-carousel",4),T()),i&2){let e=a().ngIf;c(),r("ngIf",e.length)}}function dt(i,m){if(i&1&&(b(0),x(1,st,2,1,"ng-container",1),l(2,"async"),T()),i&2){let e=a();c(),r("ngIf",u(2,1,e.product$))}}function lt(i,m){if(i&1){let e=I();d(0,"cx-media",6),l(1,"async"),f("focus",function(){let n=_(e).item,o=a();return g(o.openImage(n.container))}),p()}if(i&2){let e=m.item,t=a();K("is-active",u(1,3,t.isActive(e.container))),r("container",e.container)}}var ut=(()=>{class i{constructor(){this.mainMediaContainer=new y({}),this.productImage=new L,this.subscription=new A}ngOnInit(){this.subscription.add(this.activeThumb.subscribe(e=>{this.mainMediaContainer.next(e)}))}openImage(e){this.mainMediaContainer.next(e),typeof e.zoom?.galleryIndex=="number"&&this.productImage.emit({image:e,index:e.zoom.galleryIndex})}isActive(e){return this.mainMediaContainer.asObservable().pipe(C(oe),O(t=>t.zoom?.url&&e.zoom?.url&&t.zoom.url===e.zoom.url))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=Z({type:i,selectors:[["cx-product-image-zoom-thumbnails"]],inputs:{thumbs$:"thumbs$",activeThumb:"activeThumb"},outputs:{productImage:"productImage"},decls:4,vars:3,consts:[["thumb",""],[4,"ngIf"],["class","thumbs","itemWidth","70px",3,"items","hideIndicators","template",4,"ngIf"],["itemWidth","70px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0",3,"focus","container"]],template:function(t,n){t&1&&(x(0,Oe,2,1,"ng-container",1),l(1,"async"),x(2,Le,2,5,"ng-template",null,0,ie)),t&2&&r("ngIf",u(1,1,n.thumbs$))},dependencies:[se,F,Q,$],encapsulation:2,changeDetection:0})}}return i})(),pt=(()=>{class i{get defaultImage(){return this._defaultImage}set defaultImage(e){e&&(this._defaultImage=e,this.defaultImageReady.next(!0))}get zoomImage(){return this._zoomImage}set zoomImage(e){e&&(this._zoomImage=e,this.zoomReady.next(!0))}constructor(e,t,n,o){this.currentProductService=e,this.renderer=t,this.cdRef=n,this.breakpointService=o,this.iconType=Y,this.mainMediaContainer=new y(null),this.defaultImageReady=new y(!1),this.zoomReady=new y(!1),this.imageLoaded=new y(!1),this.subscription=new A,this.mainMediaContainer$=this.mainMediaContainer.asObservable(),this.defaultImageReady$=this.defaultImageReady.asObservable(),this.zoomReady$=this.zoomReady.asObservable(),this.featureConfigService=pe(ye),this.activeThumb=new L,this.defaultImageClickHandler$=this.defaultImageReady$.pipe(C(Boolean),E(s=>U(...this.clickOrDoubleClick(this.defaultImage)).pipe(P(()=>this.zoom())))),this.zoomImageClickHandler$=this.zoomReady$.pipe(C(Boolean),E(s=>U(...this.clickOrDoubleClick(this.zoomImage)).pipe(P(()=>this.zoom())))),this.startCoords=null,this.left=0,this.top=0,this.isZoomed=!1,this.product$=this.currentProductService.getProduct().pipe(C(oe),ue(),P(s=>{if(this.galleryIndex){let w=Array.isArray(s.images?.GALLERY)?s.images?.GALLERY.find(G=>G.zoom?.galleryIndex===this.galleryIndex):s.images?.GALLERY;this.mainMediaContainer.next(w||null)}else this.mainMediaContainer.next(s.images?.PRIMARY?s.images.PRIMARY:{})}),W(1)),this.thumbnails$=this.product$.pipe(O(s=>this.createThumbs(s)),W(1)),this.mainImage$=H([this.product$,this.mainMediaContainer$]).pipe(O(([,s])=>s)),N("a11yKeyboardAccessibleZoom")}ngOnInit(){this.subscription.add(this.defaultImageClickHandler$.subscribe()),this.subscription.add(this.zoomImageClickHandler$.subscribe())}openImage(e){this.mainMediaContainer.next(e),this.activeThumb.emit(e)}getActive(){return Array.isArray(this.mainMediaContainer.value)?this.mainMediaContainer.value[0].thumbnail?.galleryIndex||0:this.mainMediaContainer?.value?.thumbnail?.galleryIndex||0}getPreviousProduct(e){let t=this.getActive();return t===0?e[t]:e[t-1]}getNextProduct(e){let t=this.getActive();return t===e.length-1?e[t]:e[t+1]}zoom(){this.isZoomed=!this.isZoomed,this.startCoords=null,this.left=0,this.top=0,this.cdRef.markForCheck(),this.featureConfigService.isEnabled("a11yKeyboardAccessibleZoom")&&(this.imageLoaded.next(!1),this.imageLoaded.pipe(C(Boolean),le(1)).subscribe(()=>{setTimeout(()=>{this.zoomButton.nativeElement.focus()})}))}touchMove(e){let t=e.touches[0]||e.changedTouches[0],n=this.zoomedImage?.nativeElement?.getBoundingClientRect(),o=this.zoomedImage?.nativeElement?.firstChild;this.startCoords||(this.startCoords={x:t.clientX,y:t.clientY}),this.left+=t.clientX-this.startCoords.x,this.top+=t.clientY-this.startCoords.y,this.moveImage(this.left,this.top,n,o),this.startCoords={x:t.clientX,y:t.clientY}}clearTouch(){this.startCoords=null}pointerMove(e){let t=this.zoomedImage.nativeElement.getBoundingClientRect(),n=this.zoomedImage.nativeElement.firstChild,{positionX:o,positionY:s}=this.calculatePointerMovePosition(this.zoomedImage,e.clientX,e.clientY);this.moveImage(o,s,t,n)}changeImage(e){this.mainMediaContainer.next(e.image)}moveImage(e,t,n,o){let{x:s,y:w}=this.handleOutOfBounds(e,t,o,n);o&&(this.renderer.setStyle(o,"left",s+"px"),this.renderer.setStyle(o,"top",w+"px"))}ngOnDestroy(){this.subscription.unsubscribe()}clickOrDoubleClick(e){return[X(e.nativeElement,"click").pipe(E(()=>this.breakpointService.isUp(re.md)),C(Boolean)),X(e.nativeElement,"dblclick").pipe(E(()=>this.breakpointService.isDown(re.lg)),C(Boolean))]}createThumbs(e){return!e.images||!e.images.GALLERY||Array.isArray(e.images.GALLERY)&&e.images.GALLERY.length<2?[]:e.images.GALLERY.map(n=>de({container:n}))}handleOutOfBounds(e,t,n,o){return t<=-n?.height+60&&(t=-n?.height+60),t>=o?.height-60&&(t=o?.height-60),e<=-n?.width-o?.width/2+60&&(e=-n?.width-o?.width/2+60),e>=n?.width+o?.width/2-60&&(e=n?.width+o?.width/2-60),{x:e,y:t}}calculatePointerMovePosition(e,t,n){let o=e.nativeElement.getBoundingClientRect(),s=t-o.left,w=n-o.top,G=-s+e.nativeElement.clientWidth/2,Be=-w+e.nativeElement.clientHeight/2;return{positionX:G,positionY:Be}}onImageLoad(){this.imageLoaded.next(!0)}static{this.\u0275fac=function(t){return new(t||i)(v(me),v(_e),v(Ie),v(ze))}}static{this.\u0275cmp=Z({type:i,selectors:[["cx-product-image-zoom-view"]],viewQuery:function(t,n){if(t&1&&(M(Fe,5,V),M($e,5,V),M(Ne,5,V),M(Ye,5)),t&2){let o;z(o=k())&&(n.defaultImage=o.first),z(o=k())&&(n.zoomImage=o.first),z(o=k())&&(n.zoomedImage=o.first),z(o=k())&&(n.zoomButton=o.first)}},inputs:{galleryIndex:"galleryIndex"},decls:3,vars:5,consts:[["defaultImage",""],["zoomContainer",""],["zoomedImage",""],["zoomButton",""],[4,"ngIf"],[3,"productImage","thumbs$","activeThumb"],["class","cx-main-image-group",4,"ngIf"],[1,"cx-main-image-group"],[1,"cx-navigate-image"],["class","btn btn-link",3,"click",4,"ngIf"],["class","cx-image-container",4,"cxFeature"],[4,"cxFeature"],[1,"btn","btn-link",3,"click"],[3,"type"],[1,"cx-image-container"],["class","cx-default-image-zoom",3,"container","loaded",4,"ngIf"],["class","cx-zoom-container",4,"ngIf"],["class","btn btn-link cx-zoom-btn",3,"title","click",4,"ngIf"],[1,"cx-default-image-zoom",3,"loaded","container"],[1,"cx-zoom-container"],[1,"cx-image-zoomed",3,"mousemove","touchmove","touchend","loaded","container"],[1,"btn","btn-link","cx-zoom-btn",3,"click","title"],["class","cx-zoom-indicator",3,"type",4,"ngIf"],[1,"cx-zoom-indicator",3,"type"],["class","cx-default-image-zoom",3,"container",4,"ngIf"],[1,"cx-default-image-zoom",3,"container"],[1,"cx-image-zoomed",3,"mousemove","touchmove","touchend","container"]],template:function(t,n){t&1&&(x(0,it,3,3,"ng-container",4),l(1,"async"),d(2,"cx-product-image-zoom-thumbnails",5),f("productImage",function(s){return n.changeImage(s)}),p()),t&2&&(r("ngIf",u(1,3,n.mainImage$)),c(2),r("thumbs$",n.thumbnails$)("activeThumb",n.activeThumb))},dependencies:[F,j,Q,ae,ut,$,R],encapsulation:2,changeDetection:0})}}return i})(),_t=(()=>{class i{handleClick(e){e.target.tagName===this.el.nativeElement.tagName&&this.close("Cross click")}constructor(e,t){this.launchDialogService=e,this.el=t,this.iconType=Y,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0},N("a11yCloseProductImageBtnFocus")}close(e=""){this.launchDialogService.closeDialog(e)}static{this.\u0275fac=function(t){return new(t||i)(v(ce),v(V))}}static{this.\u0275cmp=Z({type:i,selectors:[["cx-product-image-zoom-dialog"]],hostBindings:function(t,n){t&1&&f("click",function(s){return n.handleClick(s)})},inputs:{galleryIndex:"galleryIndex"},decls:11,vars:12,consts:[["role","dialog",1,"cx-image-zoom-dialog",3,"esc","cxFocus"],[1,"cx-dialog-content"],[1,"cx-dialog-header"],["type","button",1,"close",3,"click","title"],["aria-hidden","true"],[3,"type"],[1,"cx-dialog-body"],[3,"galleryIndex"]],template:function(t,n){t&1&&(d(0,"div",0),l(1,"cxTranslate"),f("esc",function(){return n.close("Escape clicked")}),d(2,"div",1)(3,"div",2)(4,"button",3),l(5,"cxTranslate"),l(6,"cxTranslate"),f("click",function(){return n.close("cross click")}),d(7,"span",4),h(8,"cx-icon",5),p()()(),d(9,"div",6),h(10,"cx-product-image-zoom-view",7),p()()()),t&2&&(r("cxFocus",n.focusConfig),B("aria-label",u(1,6,"productImageZoomDialog.zoomedInImage")),c(4),q("title",u(5,8,"productImageZoomDialog.close")),B("aria-label",u(6,10,"productImageZoomDialog.close")),c(4),r("type",n.iconType.CLOSE),c(2),r("galleryIndex",n.galleryIndex))},dependencies:[j,we,pt,R],encapsulation:2,changeDetection:0})}}return i})(),gt={launch:{PRODUCT_IMAGE_ZOOM:{inline:!0,component:_t,dialogType:Ze.DIALOG}}},xt=(()=>{class i{set expandImage(e){e&&this.triggerZoom()}constructor(e,t){this.launchDialogService=e,this.vcr=t,this.iconType=Y,this.subscriptions=new A,this.dialogClose=new L,N("a11yLinkBtnsToTertiaryBtns")}triggerZoom(){let e=this.launchDialogService.launch("PRODUCT_IMAGE_ZOOM",this.vcr);e&&this.subscriptions.add(H([e,this.launchDialogService.dialogClose]).pipe(P(([t])=>{this.galleryIndex&&(t.instance.galleryIndex=this.galleryIndex)}),C(([,t])=>!!t),P(([t])=>{this.launchDialogService.clear("PRODUCT_IMAGE_ZOOM"),t?.destroy(),this.dialogClose.emit(),this.expandButton.nativeElement.focus()})).subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(t){return new(t||i)(v(ce),v(ge))}}static{this.\u0275cmp=Z({type:i,selectors:[["cx-product-image-zoom-trigger"]],viewQuery:function(t,n){if(t&1&&M(nt,5),t&2){let o;z(o=k())&&(n.expandButton=o.first)}},inputs:{galleryIndex:"galleryIndex",expandImage:"expandImage"},outputs:{dialogClose:"dialogClose"},decls:2,vars:2,consts:[["expandButton",""],["class","btn btn-tertiary",3,"click",4,"cxFeature"],["class","btn btn-link cx-action-link",3,"click",4,"cxFeature"],[1,"btn","btn-tertiary",3,"click"],[3,"type"],[1,"btn","btn-link","cx-action-link",3,"click"]],template:function(t,n){t&1&&x(0,ot,5,4,"button",1)(1,at,6,4,"button",2),t&2&&(r("cxFeature","a11yLinkBtnsToTertiaryBtns"),c(),r("cxFeature","!a11yLinkBtnsToTertiaryBtns"))},dependencies:[j,ae,R],encapsulation:2,changeDetection:0})}}return i})(),ft=(()=>{class i extends De{constructor(e){super(e),this.currentProductService=e,this.expandImage=new y(!1),this.product$=this.product$}openImage(e){this.mainMediaContainer.next(e),this.selectedIndex=this.mainMediaContainer.value?.zoom?.galleryIndex}triggerZoom(e){this.expandImage.next(e)}static{this.\u0275fac=function(t){return new(t||i)(v(me))}}static{this.\u0275cmp=Z({type:i,selectors:[["cx-product-images"]],features:[xe],decls:6,vars:6,consts:[["thumb",""],[4,"ngIf"],[3,"click","container"],[3,"dialogClose","expandImage","galleryIndex"],["role","region","tabindex","-1","class","thumbs","itemWidth","120px",3,"items","hideIndicators","template",4,"ngIf"],["role","region","tabindex","-1","itemWidth","120px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0","format","product",3,"focus","container"]],template:function(t,n){t&1&&(x(0,ct,3,3,"ng-container",1),l(1,"async"),x(2,dt,3,3,"ng-container",1),l(3,"async"),x(4,lt,2,5,"ng-template",null,0,ie)),t&2&&(r("ngIf",u(1,2,n.mainImage$)),c(2),r("ngIf",u(3,4,n.thumbs$)))},dependencies:[se,F,Q,xt,$,R],encapsulation:2,changeDetection:0})}}return i})(),ht=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=D({providers:[ne(gt),ne({cmsComponents:{ProductImagesComponent:{component:ft}}})],imports:[Ee,ve,Te,Me,Pe,ke,Ve,Ce,be]})}}return i})(),Se=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=D({imports:[ht]})}}return i})();var Ot=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=S({type:i})}static{this.\u0275inj=D({imports:[Se]})}}return i})();export{Ot as ProductImageZoomModule};
